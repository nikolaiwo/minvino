(function(e){function t(t){for(var a,r,s=t[0],l=t[1],c=t[2],m=0,d=[];m<s.length;m++)r=s[m],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&d.push(i[r][0]),i[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);u&&u(t);while(d.length)d.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(a=!1)}a&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},i={app:0},o=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/minvino/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"nav"}},[n("router-link",{attrs:{to:"/"}},[e._v("minVino")])],1),n("router-view")],1)},o=[],r=(n("034f"),n("2877")),s={},l=Object(r["a"])(s,i,o,!1,null,null,null),c=l.exports,u=n("8c4f"),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-container",[n("keep-alive",[n("WineTable")],1)],1)],1)},d=[],p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-row",[n("b-col",[n("b-form-select",{attrs:{value:e.selectedCategory,options:e.wineTableCategories},on:{change:e.setSelectedCategory},scopedSlots:e._u([{key:"first",fn:function(){return[n("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("Filtrer på kategori")])]},proxy:!0}])})],1),n("b-col",[n("b-row",{staticClass:"my-1"},[n("b-col",{attrs:{sm:"5"}},[n("label",{attrs:{for:"input-minimumPoints"}},[e._v("Minimum poeng:")])]),n("b-col",{attrs:{sm:"7"}},[n("b-form-input",{attrs:{id:"input-minimumPoints",state:Number.isInteger(parseInt(e.minimumPoints))},on:{change:e.fetchFilteredData},model:{value:e.minimumPoints,callback:function(t){e.minimumPoints=t},expression:"minimumPoints"}})],1)],1)],1)],1),n("b-table",{ref:"wineTable",attrs:{responsive:"sm",hover:"",selectable:"","select-mode":"single","sort-by":e.sortBy,"sort-desc":e.sortDesc,items:e.filteredWineTableData,fields:e.fields},on:{"update:sortBy":function(t){e.sortBy=t},"update:sort-by":function(t){e.sortBy=t},"update:sortDesc":function(t){e.sortDesc=t},"update:sort-desc":function(t){e.sortDesc=t},"row-clicked":e.rowClicked},scopedSlots:e._u([{key:"cell(score)",fn:function(t){return[e._v(" "+e._s((100*t.value).toFixed(1))+" ")]}},{key:"cell(availableOnline)",fn:function(t){return[t.value?n("span",[e._v("✅")]):n("span",[e._v("❌")])]}},{key:"cell(price)",fn:function(t){return[e._v(" "+e._s(t.value.toFixed(0))+",- ")]}},{key:"cell(volume)",fn:function(t){return[e._v(" "+e._s(100*t.value)+" cl ")]}},{key:"row-details",fn:function(e){return[n("b-card",[n("SingleWineView",{attrs:{articleNumber:e.item.productId}})],1)]}}])}),e.fetchingData?n("b-spinner",{attrs:{label:"Loading..."}}):e._e()],1)},v=[],f=(n("4160"),n("159b"),n("96cf"),n("1da1")),b=n("5530"),g=n("2f62"),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",[e.fetchingWineData?n("b-spinner"):n("div",[n("h1",[e._v(e._s(e.wineData.vinmonopoletData.name))]),n("b-row",[n("b-col",{attrs:{sm:"10"}},[n("dl",{staticClass:"row"},[n("dt",{staticClass:"col-sm-3"},[e._v("DN")]),n("dd",{staticClass:"col-sm-9"},[""!=e.wineData.dnPoints?n("div",[n("b",[e._v(e._s(e.wineData.dnPoints)+" Poeng")]),e._v(" "),n("br"),n("a",{attrs:{href:e.wineData.dnLink}},[e._v(" "+e._s(e.wineData.dnTasteNote)+" ")])]):n("div",[e._v("Ingen rating funnet")])]),n("dt",{staticClass:"col-sm-3"},[e._v("Apertif")]),n("dd",{staticClass:"col-sm-9"},[""!=e.wineData.apertifPoints?n("div",[n("b",[e._v(e._s(e.wineData.apertifPoints)+" Poeng")]),e._v(" "),n("br"),n("a",{attrs:{href:e.wineData.apertifLink}},[e._v(" "+e._s(e.wineData.apertifTasteNote)+" ")])]):n("div",[e._v("Ingen rating funnet")])]),n("dt",{staticClass:"col-sm-3"},[e._v("Link til Vinmonopolet")]),n("dd",{staticClass:"col-sm-9"},[n("a",{attrs:{href:"https://www.vinmonopolet.no/"+e.wineData.vinmonopoletData.url}},[e._v(" "+e._s(e.wineData.vinmonopoletData.name)+" ")])]),n("dt",{staticClass:"col-sm-3"},[e._v("Pris")]),n("dd",{staticClass:"col-sm-9"},[e._v(e._s(e.wineData.vinmonopoletData.price.value.toFixed(2))+" kr")]),n("dt",{staticClass:"col-sm-3"},[e._v("Kategori")]),n("dd",{staticClass:"col-sm-9"},[e._v(e._s(e.wineData.vinmonopoletData.main_category.name))]),n("dt",{staticClass:"col-sm-3"},[e._v("Volum")]),n("dd",{staticClass:"col-sm-9"},[e._v(e._s(100*e.wineData.vinmonopoletData.volume.value)+" cl")]),n("dt",{staticClass:"col-sm-3"},[e._v("Land, område")]),n("dd",{staticClass:"col-sm-9"},[e._v(" "+e._s(e.wineData.vinmonopoletData.main_country.name)+" "),null!=e.wineData.vinmonopoletData.district&&"Øvrige"!=e.wineData.vinmonopoletData.district.name&&"-"!=e.wineData.vinmonopoletData.district.name?n("span",[e._v(", "+e._s(e.wineData.vinmonopoletData.district.name))]):e._e(),null!=e.wineData.vinmonopoletData.sub_District&&"Øvrige"!=e.wineData.vinmonopoletData.sub_District.name&&"-"!=e.wineData.vinmonopoletData.sub_District.name?n("span",[e._v(", "+e._s(e.wineData.vinmonopoletData.sub_District.name))]):e._e()]),n("dt",{staticClass:"col-sm-3"},[e._v("Kan leveres")]),n("dd",{staticClass:"col-sm-9"},[e.wineData.vinmonopoletData.availability.deliveryAvailability.available?n("div",[e._v("✅")]):n("div",[e._v("❌")])]),n("dt",{staticClass:"col-sm-3"},[e._v("I butikk")]),n("dd",{staticClass:"col-sm-9"},[e.wineData.vinmonopoletData.availability.storeAvailability.available?n("div",[e._v("✅")]):n("div",[e._v("❌")])])])]),n("b-col",{attrs:{sm:"2"}},[n("b-img",{attrs:{thumbnail:"",fluid:"",src:e.wineData.vinmonopoletData.images[0].url,alt:"Image 1"}})],1)],1)],1)],1)},D=[],w={name:"SingleWineView",props:{articleNumber:String},computed:Object(b["a"])({},Object(g["b"])({wineData:function(e){return e.db.wineData},fetchingWineData:function(e){return e.db.fetchingWineData}})),created:function(){this.$store.dispatch("db/fetchWineData",this.articleNumber)}},y=w,_=(n("9016"),Object(r["a"])(y,h,D,!1,null,"249c1ec9",null)),C=_.exports,k={data:function(){return{fields:[{key:"name",sortable:!0,label:"Navn"},{key:"dnPoints",sortable:!0,label:"DN"},{key:"apertifPoints",sortable:!0,label:"Aperitif"},{key:"price",sortable:!0,label:"Pris"},{key:"category",sortable:!0,label:"Kategori"},{key:"volume",label:"Volum"},{key:"score",sortable:!0,label:"Score"},{key:"availableOnline",sortable:!1,label:"Kan leveres"}],selectMode:"multi",selected:[],app:null,collection:null,minimumPoints:90,sortBy:"score",sortDesc:!0,items:[],lastSelected:null,wineTableCategories:["Sterkvin","Rødvin","Musserende vin","Hvitvin","Brennevin","Øl","Rosévin","Sake","Sider","Perlende vin","Fruktvin","Mjød","Alkoholfritt","Aromatisert vin"]}},components:{SingleWineView:C},computed:Object(b["a"])(Object(b["a"])({},Object(g["b"])({wineTableData:function(e){return e.db.wineTableData},fetchingData:function(e){return e.db.fetchingWineTableData},selectedCategory:function(e){return e.db.selectedCategory}})),{},{filteredWineTableData:function(){var e=this,t=[];return this.selectedCategory?(this.wineTableData.forEach((function(n){n.category==e.selectedCategory&&t.push(n)})),t):this.wineTableData}}),methods:{viewSingleComponent:function(e){console.log(e),this.$router.push({path:"/wine/".concat(e.productId)})},fetchFilteredData:function(){var e={minimumPoints:this.minimumPoints};this.$store.dispatch("db/fetchBaseWineData",e)},setSelectedCategory:function(e){this.$store.commit("db/setSelectedCategory",e),this.$store.dispatch("db/fetchBaseWineData",{minimumPoints:this.minimumPoints})},rowClicked:function(e){e!==this.lastSelected&&(e._showDetails=!0),this.lastSelected&&(this.lastSelected._showDetails=!1),e===this.lastSelected?this.lastSelected=null:this.lastSelected=e}},mounted:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log(e.wineTableData),0==e.wineTableData.length&&e.$store.dispatch("db/fetchBaseWineData",{minimumPoints:e.minimumPoints});case 2:case"end":return t.stop()}}),t)})))()}},T=k,P=Object(r["a"])(T,p,v,!1,null,null,null),W=P.exports,x={components:{WineTable:W}},O=x,S=Object(r["a"])(O,m,d,!1,null,null,null),j=S.exports;a["default"].use(u["a"]);var A=[{path:"/",name:"Home",component:j},{path:"/wine/:articleNumber",component:C,props:!0}],N=new u["a"]({mode:"history",base:"/minvino/",routes:A}),R=N,I=(n("99af"),n("b0c0"),n("d3b7"),n("6062"),n("3ca3"),n("ddb0"),n("d40a")),F=n("bc3a"),B=n.n(F),q={user:null,app:null,wineTableData:[],wineTableCategories:[],fetchingWineTableData:!1,wineData:{},fetchingWineData:!1,selectedCategory:null},$={isAuthenticated:function(e){return!!e.user},appCreated:function(e){return!!e.app}},E={logIn:function(e){return Object(f["a"])(regeneratorRuntime.mark((function t(){var n,a,i,o,r,s,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.commit,a=e.getters,console.log("Logging in"),a.appCreated){t.next=8;break}return i="minvino-aiide",o={id:i},r=new I["a"](o),t.next=8,n("setApp",r);case 8:if(a.isAuthenticated){t.next=16;break}return s=I["b"].anonymous(),t.next=12,q.app.logIn(s);case 12:return l=t.sent,console.log(l),t.next=16,n("setUser",l);case 16:case"end":return t.stop()}}),t)})))()},fetchBaseWineData:function(e,t){return Object(f["a"])(regeneratorRuntime.mark((function n(){var a,i,o,r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a=e.dispatch,i=e.state,o=t.minimumPoints,i.selectedCategory?(console.log("Fetching data for category "+i.selectedCategory),s={query:'\n              {\n                wineData(\n                    sortBy: SCORE_DESC\n                    query: {\n                      AND: [\n                          {\n                              vinmonopoletData: {\n                                buyable: true,\n                                main_category: {\n                                    name: "'.concat(i.selectedCategory,'"\n                                }\n                          }}\n                          {\n                            OR: [\n                                {dnPoints_gt: "').concat(o,'"},\n                                {apertifPoints_gt: "').concat(o,'"}\n                            ]\n                            }\n                      ]\n                  }\n                    limit:100\n                  ){\n                  vinmonopoletData {\n                    name,\n                    price {\n                      value\n                    },\n                    main_category {\n                      name\n                    },\n                    main_sub_category {\n                      name\n                    },\n                    volume {\n                        value\n                    },\n                    availability {\n                      deliveryAvailability {\n                        available\n                      }\n                    }\n                  }\n                  dnPoints\n                  apertifPoints\n                  dnTasteNote\n                  apertifTasteNote\n                  score\n                  productId\n                }\n              }')},a("fetchWineTableData",s)):(r={query:'\n              {\n                wineData(\n                    sortBy: SCORE_DESC\n                    query: {\n                      AND: [\n                          {vinmonopoletData: {\n                              buyable: true,\n                          }}\n                          {\n                              OR: [\n                                  {dnPoints_gt: "'.concat(o,'"},\n                                  {apertifPoints_gt: "').concat(o,'"}\n                              ]\n                          }\n                      ]\n                  }\n                    limit:100\n                  ){\n                  vinmonopoletData {\n                    name,\n                    price {\n                      value\n                    },\n                    main_category {\n                      name\n                    },\n                    main_sub_category {\n                      name\n                    },\n                    volume {\n                        value\n                    },\n                    availability {\n                      deliveryAvailability {\n                        available\n                      }\n                    }\n                  }\n                  dnPoints\n                  apertifPoints\n                  dnTasteNote\n                  apertifTasteNote\n                  score\n                  productId\n                }\n              }')},a("fetchWineTableData",r));case 3:case"end":return n.stop()}}),n)})))()},fetchWineTableData:function(e,t){return Object(f["a"])(regeneratorRuntime.mark((function n(){var a,i,o,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.commit,i=e.getters,o=e.dispatch,a("setWineTableData",[]),a("setFetchingWineTableData",!0),i.isAuthenticated){n.next=6;break}return n.next=6,o("logIn");case 6:return console.log(i.isAuthenticated),n.next=9,q.app.currentUser.refreshCustomData();case 9:r={headers:{Authorization:"Bearer ".concat(q.app.currentUser.accessToken)}},B.a.post("https://realm.mongodb.com/api/client/v2.0/app/minvino-aiide/graphql",t,r).then((function(e){var t=e.data.data.wineData,n=new Set;t.forEach((function(e){n.add(e.vinmonopoletData.main_category.name),e.category=e.vinmonopoletData.main_category.name,e.price=e.vinmonopoletData.price.value,e.name=e.vinmonopoletData.name,e.volume=e.vinmonopoletData.volume.value,e.availableOnline=e.vinmonopoletData.availability.deliveryAvailability.available,delete e.vinmonopoletData})),console.log(e),a("setFetchingWineTableData",!1),a("setWineTableData",t)})).catch((function(e){a("setFetchingWineTableData",!1),console.log(e)}));case 11:case"end":return n.stop()}}),n)})))()},fetchWineTableCategories:function(e){return Object(f["a"])(regeneratorRuntime.mark((function t(){var n,a,i,o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.commit,a=e.getters,i=e.dispatch,console.log("fetching wine categories"),n("setWineTableCategories",[]),a.isAuthenticated){t.next=6;break}return t.next=6,i("logIn");case 6:return t.next=8,q.app.currentUser.refreshCustomData();case 8:o={query:"\n          {\n            wineDatum{\n                uniqueCategories\n            }\n          }"},r={headers:{Authorization:"Bearer ".concat(q.app.currentUser.accessToken)}},B.a.post("https://realm.mongodb.com/api/client/v2.0/app/minvino-aiide/graphql",o,r).then((function(e){var t=e.data.data.wineDatum.uniqueCategories;console.log(e.data),n("setWineTableCategories",t)})).catch((function(e){console.log(e)}));case 11:case"end":return t.stop()}}),t)})))()},fetchWineData:function(e,t){return Object(f["a"])(regeneratorRuntime.mark((function n(){var a,i,o,r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.commit,i=e.getters,o=e.dispatch,a("setWineData",{}),a("setFetchingWineData",!0),r={query:'\n          {\n            wineData(\n                query: {\n                    productId: "'.concat(t,'"\n              }){\n                vinmonopoletData {\n                    name,\n                    distributor,\n                    images {\n                        url\n                    },\n                    alcohol {\n                      value\n                    },\n                    price {\n                      value\n                    },\n                    main_category {\n                      name\n                    },\n                    main_sub_category {\n                      name\n                    },\n                    main_country {\n                      name\n                    },\n                    district {\n                      name\n                    },\n                    sub_District {\n                      name\n                    },\n                    volume {\n                        value\n                    }\n                    availability {\n                      storeAvailability {\n                        available\n                      },\n                      deliveryAvailability {\n                        available\n                      }\n                    },\n                    url\n                  }\n              dnPoints\n              apertifPoints\n              dnTasteNote\n              apertifTasteNote\n              score\n              productId\n              dnLink\n              apertifLink\n            }\n          }')},i.isAuthenticated){n.next=7;break}return n.next=7,o("logIn");case 7:return console.log(i.isAuthenticated),n.next=10,q.app.currentUser.refreshCustomData();case 10:s={headers:{Authorization:"Bearer ".concat(q.app.currentUser.accessToken)}},B.a.post("https://realm.mongodb.com/api/client/v2.0/app/minvino-aiide/graphql",r,s).then((function(e){a("setWineData",e.data.data.wineData[0]),a("setFetchingWineData",!1),console.log(e)})).catch((function(e){a("setFetchingWineData",!1),console.log(e)}));case 12:case"end":return n.stop()}}),n)})))()}},L={setApp:function(e,t){e.app=t},setFetchingWineTableData:function(e,t){e.fetchingWineTableData=t},setWineTableCategories:function(e,t){e.wineTableCategories=t},setWineTableData:function(e,t){e.wineTableData=t},setWineData:function(e,t){e.wineData=t},setFetchingWineData:function(e,t){e.fetchingWineData=t},setUser:function(e,t){e.user=t},setSelectedCategory:function(e,t){e.selectedCategory=t},logOut:function(e){e.user=null,e.posts=null}},M={state:q,getters:$,actions:E,mutations:L,namespaced:!0};a["default"].use(g["a"]);var U=new g["a"].Store({state:{},mutations:{},actions:{},modules:{db:M}}),V=n("5f5b"),K=n("b1e0");n("f9e3"),n("2dd8");a["default"].config.productionTip=!1,a["default"].use(V["a"]),a["default"].use(K["a"]),new a["default"]({router:R,store:U,render:function(e){return e(c)}}).$mount("#app")},"85ec":function(e,t,n){},9016:function(e,t,n){"use strict";n("a0a7")},a0a7:function(e,t,n){}});
//# sourceMappingURL=app.85e9ec61.js.map